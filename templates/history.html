<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>History - AI Research Assistant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3 bg-dark text-white sidebar py-4">
                <h4 class="text-center mb-4">AI Assistant</h4>
                <a href="{{ url_for('dashboard') }}" class="text-white d-block my-2 nav-link">Dashboard</a>
                <a href="{{ url_for('history') }}" class="text-white d-block my-2 nav-link active">History</a>
                <a href="{{ url_for('logout') }}" class="text-white d-block my-2 nav-link">Logout</a>
            </div>

            <div class="col-md-9 content py-4 px-5">
                <h2 class="mb-4">Your Summary History</h2>

                {% if history_records %}
                    <div class="list-group">
                        {% for item in history_records %}
                        <div class="list-group-item list-group-item-action flex-column align-items-start mb-3 shadow-sm rounded">
                            <div class="d-flex w-100 justify-content-between">
                                <h5 class="mb-1">{{ item['topic'] }}</h5>
                                <small>{{ item['timestamp'] }}</small>
                            </div>
                            <div class="summary-content mt-2">
                                {{ item['summary'] | safe }}
                            </div>
                            
                            {% if item['image_path'] %}
                            <div class="mt-3 text-center">
                                <img src="{{ url_for('static', filename=item['image_path']) }}" alt="Generated Image" class="img-fluid rounded shadow-sm" style="max-height: 250px;">
                            </div>
                            {% endif %}
                            
                            <a href="{{ url_for('download', history_id=item['id']) }}" class="btn btn-primary btn-sm mt-3">Download PDF</a>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="alert alert-info">No history available yet. Generate a summary first!</div>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>